<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Recorder</title>
    <script>
        let TTS_type = 'Google';
        let LLM_type = 'gpt2';
        let STT_type = 'Google';

        function updateModel(type, value) {
            if (type === 'TTS') {
                TTS_type = value;
            } else if (type === 'LLM') {
                LLM_type = value;
            } else if (type === 'STT') {
                STT_type = value;
            }
            console.log(`TTS_type: ${TTS_type}, LLM_type: ${LLM_type}, STT_type: ${STT_type}`);
        }

        async function saveSetting() {
            const response = await fetch('https://machinelearning.vinunilegacy.com/api/setting', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json' // Indicate JSON content type
                },
                body: JSON.stringify({TTS_type, LLM_type, STT_type})
            });
            if (LLM_type == "gpt-4o-mini"){
                const getLLMStreamingResponse = document.getElementById('getLLMStreamingResponse');
                getLLMStreamingResponse.disabled = false;
            }
            else {
                const getLLMStreamingResponse = document.getElementById('getLLMStreamingResponse');
                getLLMStreamingResponse.disabled = true;
            }
        }
    </script>
</head>
<body>
    <div>
        <h2>Framework Settings</h2>
        <h3>Choose a TTS client</h3>
        <label><input type="radio" name="TTS" value="Google" onclick="updateModel('TTS', 'Google')" checked> Google</label><br>
        <label><input type="radio" name="TTS" value="Deepgram" onclick="updateModel('TTS', 'Deepgram')"> Deepgram</label><br>
        <!-- <label><input type="radio" name="TTS" value="Microsoft" onclick="updateModel('TTS', 'Microsoft')"> Microsoft</label><br> -->
    
        <h3>Choose an LLM model</h3>
        <label><input type="radio" name="LLM" value="gpt2" onclick="updateModel('LLM', 'gpt2')" checked> GPT-2</label><br>
        <!-- <label><input type="radio" name="LLM" value="gpt3" onclick="updateModel('LLM', 'gpt3')"> GPT-3</label><br> -->
        <label><input type="radio" name="LLM" value="gpt-4o-mini" onclick="updateModel('LLM', 'gpt-4o-mini')"> gpt-4o-mini</label><br>
    
        <h3>Choose a STT model</h3>
        <label><input type="radio" name="STT" value="Google" onclick="updateModel('STT', 'Google')" checked> Google</label><br>
        <label><input type="radio" name="STT" value="Deepgram" onclick="updateModel('STT', 'Deepgram')"> Deepgram</label><br>
        <!-- <label><input type="radio" name="STT" value="Microsoft" onclick="updateModel('STT', 'Microsoft')"> Microsoft</label><br> -->
        <button id="saveSettings" onclick="saveSetting()">Save</button>
    </div>
    <div>
        <h2>End2end testing:</h2>
        <button id="e2eRecordButton">Record</button>
        <button id="e2eStopButton" disabled>Stop</button>
        <audio id="e2eAudioPreview" controls></audio>
        <h3>End2end output:</h3>
        <audio id="e2eAudioOutput" controls></audio>
        <h4>Time taken: <span id="e2eTimeTaken"></span> seconds</h4>
    </div>
    <div>
        <h2>Partial Testing</h2>
        <button id="recordButton">Record</button>
        <button id="stopButton" disabled>Stop</button>
        <audio id="audioPreview" controls></audio>
    </div>
    <div>
        <h3>STT transcipt:</h3>
        <button id="getTranscriptButton">Get Transcript</button>
        <h4>Transcript: <span id="transcriptSTT"></span></h4>
        <h4>Time taken: <span id="timeTakenSTT"></span> seconds</h4>
    </div>
    <div>
        <h3>LLM response:</h3>
        <button id="getLLMResponse">Get Reponse</button>
        <button id="getLLMStreamingResponse" disabled>Get Streaming Reponse</button>
        <h4>Transcript: <span id="responseLLM"></span></h4>
        <h4>Time taken: <span id="timeTakenLLM"></span> seconds</h4>
    </div>
    <div>
        <h3>TTS response:</h3>
        <button id="getTTSResponse">Get Voice Reponse</button>
        <h4>Response: 
            <audio id="audioResponseTTS" controls></audio>
        </h4>
        <h4>Time taken: <span id="timeTakenTTS"></span> seconds</h4>
    </div>

    <p id="status">Not Connected</p>
    <p>Transcript: <p id="transcript"></p></p>
    <button id="connectAPI" >Connect</button>
    <button id="startTranscribe" >Start Transcribing</button>
    <button id="stopTranscribe" disabled>Stop Transcribing</button>
    <script src="index.js?27"></script>
</body>
</html>
